<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="utf-8">
  
  <title>Sitecore Render Field - Before and After Values Fixed | Sitecore Nuts &amp; Bolts</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="I have come across this issue many times in implementing Sitecore websites. You need a field to show on the page with some surrounding markup. The field is optional, and if the field has no content, t">
<meta name="keywords" content="Sitecore,Pipelines,Render Field">
<meta property="og:type" content="article">
<meta property="og:title" content="Sitecore Render Field - Before and After Values Fixed">
<meta property="og:url" content="http://www.sitecorenutsbolts.net/2015/10/26/Sitecore-Render-Field-Before-and-After-Values/index.html">
<meta property="og:site_name" content="Sitecore Nuts &amp; Bolts">
<meta property="og:description" content="I have come across this issue many times in implementing Sitecore websites. You need a field to show on the page with some surrounding markup. The field is optional, and if the field has no content, t">
<meta property="og:locale" content="en">
<meta property="og:image" content="http://www.sitecorenutsbolts.net/2015/10/26/Sitecore-Render-Field-Before-and-After-Values/all-the-processors.jpg">
<meta property="og:updated_time" content="2020-05-12T14:52:21.817Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Sitecore Render Field - Before and After Values Fixed">
<meta name="twitter:description" content="I have come across this issue many times in implementing Sitecore websites. You need a field to show on the page with some surrounding markup. The field is optional, and if the field has no content, t">
<meta name="twitter:image" content="http://www.sitecorenutsbolts.net/2015/10/26/Sitecore-Render-Field-Before-and-After-Values/all-the-processors.jpg">
  
  

  <link rel="stylesheet" href="/css/style.css">
  
  
  


  

<!--
  
    <link href='//fonts.useso.com/css?family=Titillium+Web:300,400,600' rel='stylesheet' type='text/css'>
    <link href="//fonts.useso.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
-->
</head>
</html>
<body>
  <div id="wrap">
    <header id="header">
  <div id="header-outer" class="outer">
    <div class="container">
      <div class="container-inner">
        <div id="header-title">
          <h1 class="logo-wrap">
            <a href="/" class="logo"></a>
          </h1>
          
            <h2 class="subtitle-wrap">
              <p class="subtitle">Design it, Code it, Build it. C# &amp; Sitecore!</p>
            </h2>
          
          
          <div class="mvp">
            <a href="http://www.sitecore.net/mvp" target="_blank">
              <img src="/about/index/MVP2016.jpg" alt="Sitecore MVP 2016-2020">
            </a>
            <a href="http://www.sitecore.net/mvp" target="_blank">
              <img src="/about/index/Technology2020.jpg" alt="Sitecore MVP 2016-2020">
            </a>
            <a href="http://www.sitecore.net/mvp" target="_blank">
              <img src="/about/index/Technology2019.jpg" alt="Sitecore MVP 2016-2020">
            </a>
            <a href="http://www.sitecore.net/mvp" target="_blank">
              <img src="/about/index/Technology2018.jpg" alt="Sitecore MVP 2016-2020">
            </a>
            <a href="http://www.sitecore.net/mvp" target="_blank">
                <img src="/about/index/Technology2017.jpg" alt="Sitecore MVP 2016-2020">
            </a>
            <a href="http://www.sitecore.net/mvp" target="_blank">
                <img src="/about/index/Technology2016.jpg" alt="Sitecore MVP 2016-2020">
            </a>
          </div>
          
        </div>
        <div id="header-inner" class="nav-container">
          <a id="main-nav-toggle" class="nav-icon"></a>
          <div class="nav-container-inner">
            <ul id="main-nav">
              
            </ul>
            <nav id="sub-nav">
              <div id="search-form-wrap">
                <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><input type="hidden" name="sitesearch" value="http://www.sitecorenutsbolts.net"></form>
              </div>
            </nav>
          </div>
        </div>
      </div>
    </div>
  </div>
</header>
    <div class="container">
      <div class="main-body container-inner">
        <div class="main-body-inner">
          <section id="main">
            <div class="main-body-header">

              <h1 class="header"><a class="page-title-link" href="/categories/Sitecore/">Sitecore</a></h1>
            </div>
            <div class="main-body-content">
              
  <article id="post-Sitecore-Render-Field-Before-and-After-Values" class="article article-single article-type-post" itemscope itemprop="blogPost">
    <div class="article-inner">
      <!--  -->
      
        <header class="article-header">
          
  
    <h1 class="article-title" itemprop="name">
      Sitecore Render Field - Before and After Values Fixed
    </h1>
  

        </header>
      
      <p class="article-byline">
        <a href="/2015/10/26/Sitecore-Render-Field-Before-and-After-Values/" class="article-date">
  <time datetime="2015-10-26T16:23:48.000Z" itemprop="datePublished">2015-10-26</time>
</a>
      </p>
      <div class="article-entry" itemprop="articleBody">
        <code>Estimated reading time:<span class="eta"></span></code>
        <p>I have come across this issue many times in implementing Sitecore websites. You need a field to show on the page with some surrounding markup. The field is optional, and if the field has no content, the markup should not be displayed at all. A common way I have seen this done is by just checking the value of the field before calling the render method:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">@if (!string.IsNullOrWhiteSpace(item["myfield"]))&#123;</span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"surrounding-markup-styles"</span>&gt;</span></span><br><span class="line">        @Html.Sitecore().Field("myfield", item)</span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>But apart from looking a bit ugly and verbose, it means we have to get the contents of the field twice. We could do that in the controller/business layer of our project. But then we would be mixing presentation into the business layer. Also in this example, the experience editor is not supported. We would have to add an extra check for page edit mode!</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">@if (!string.IsNullOrWhiteSpace(item["myfield"]) || Sitecore.Context.PageMode.IsPageEditor)&#123;</span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"surrounding-markup-styles"</span>&gt;</span></span><br><span class="line">        @Html.Sitecore().Field("myfield", item)</span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>No imagine that you have 10 fields like that on your rendering, things are starting to get very ugly!</p>
<h3 id="RenderFieldArgs"><a href="#RenderFieldArgs" class="headerlink" title="RenderFieldArgs"></a>RenderFieldArgs</h3><p>In the <code>RenderFieldArgs</code> we find a couple of properties that might help. There is <code>EnclosingTag</code>, this is just a string containing the type of tag, <code>h1</code>, <code>div</code> etc… - the field renderer pipeline then surrounds the field content with that tag. Helpfull, but a bit limiting.</p>
<p>There are also properties for <code>Before</code> and <code>After</code> - now we are getting closer. These properties take a string containing whatever markup you want to add and logically add those string <em>before</em> and <em>after</em> the field.</p>
<p>So how do we use those parameters. Well one of the overloads for <code>Html.Sitecore().Field</code> is <code>string fieldName, Item item, object parameters</code> - this parameters object takes a dynamic object and converts the properties on the dynamic to matching properties on <code>RenderFieldArgs</code>, so using this method you can set <em>any</em> property in the <code>RenderFieldArgs</code> object.</p>
<p>Example (Standard Sitecore):<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- Enclosing Tag - renders "&lt;h2&gt;Field Content&lt;/h2&gt;" --&gt;</span></span><br><span class="line">@Html.Sitecore().Field("myfield", item, new &#123; EnclosingTag = "h2" &#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- Before &amp; After - renders "&lt;div class="example"&gt;Field Content&lt;/div&gt;" --&gt;</span></span><br><span class="line">@Html.Sitecore().Field("myfield", item, new &#123; Before = "<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">\</span>"<span class="attr">example</span>\"&gt;</span>", After = "<span class="tag">&lt;/<span class="name">div</span>&gt;</span>" &#125;)</span><br></pre></td></tr></table></figure></p>
<p>As a site note, if you are using <a href="http://fortis.ws" target="_blank" rel="noopener">Fortis</a> - we have mirrored this implementation of the field renderer. So you can use the <code>.Render</code> method of a field wrapper and set the same properties.</p>
<p>Example (Using Fortis):<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- Enclosing Tag - renders "&lt;h2&gt;Field Content&lt;/h2&gt;" --&gt;</span></span><br><span class="line">@Model.MyField.Render(new &#123; EnclosingTag = "h2" &#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- Before &amp; After - renders "&lt;div class="example"&gt;Field Content&lt;/div&gt;" --&gt;</span></span><br><span class="line">@Model.MyField.Render(new &#123; Before = "<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">\</span>"<span class="attr">example</span>\"&gt;</span>", After = "<span class="tag">&lt;/<span class="name">div</span>&gt;</span>" &#125;)</span><br></pre></td></tr></table></figure></p>
<p>This looks much better. Nice and clean and keeps page editor support. You can imagine my dissapointment then when I discovered that Sitecore renders both the enclosing tag and the before and after fields, even if the field content is empty. </p>
<blockquote>
<p>####UPDATE:<br>The enclosing tag field does not render the tags if the field is empty, and so works as expected. Before and After do not work the same way.</p>
</blockquote>
<h3 id="Time-to-override-the-Processor"><a href="#Time-to-override-the-Processor" class="headerlink" title="Time to override the Processor!"></a>Time to override the Processor!</h3><img src="/2015/10/26/Sitecore-Render-Field-Before-and-After-Values/all-the-processors.jpg" title="Override All The Processors!">
<p>The pipeline pipeline that handles all this is the imaginatively titled <code>AddBeforeAndAfterValues</code> in the <code>RenderFieldPipeline</code>. Its a pretty simple processor and the change to make it work as expected was also fairly simple:</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> Sitecore.Diagnostics;</span><br><span class="line"><span class="keyword">using</span> Sitecore.Pipelines.RenderField;</span><br><span class="line"><span class="keyword">using</span> Sitecore.StringExtensions;</span><br><span class="line"></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> Adds the before, after and enclosing tag.</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> </span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">public class AddBeforeAndAfterValues : Sitecore.Pipelines.RenderField.AddBeforeAndAfterValues</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> Runs the processor.</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> </span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name="args"&gt;</span>The arguments.<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> new <span class="keyword">void</span> <span class="title">Process</span>(<span class="params">RenderFieldArgs args</span>)</span></span><br><span class="line"><span class="function"></span>	&#123;</span><br><span class="line">        Assert.ArgumentNotNull(args, <span class="string">"args"</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Don't add any extra markup if the field is empty, unless we are in page edit mode</span></span><br><span class="line">        <span class="keyword">if</span> (Sitecore.Context.PageMode.IsPageEditor == <span class="literal">false</span> &amp;&amp; <span class="keyword">string</span>.IsNullOrWhiteSpace(args.Result.FirstPart) &amp;&amp;</span><br><span class="line">            <span class="keyword">string</span>.IsNullOrWhiteSpace(args.Result.LastPart))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">base</span>.Process(args);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Finally - create an include file that replaces the original processor with your new one:<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span> <span class="attr">xmlns:patch</span>=<span class="string">"http://www.sitecore.net/xmlconfig/"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">sitecore</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">pipelines</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">renderField</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">processor</span> <span class="attr">type</span>=<span class="string">"Sitecore.Pipelines.RenderField.AddBeforeAndAfterValues, Sitecore.Kernel"</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">patch:attribute</span> <span class="attr">name</span>=<span class="string">"type"</span>&gt;</span>LM.Ignite.Core.Pipelines.RenderField.AddBeforeAndAfterValues, LM.Ignite.Core<span class="tag">&lt;/<span class="name">patch:attribute</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">processor</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">renderField</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">pipelines</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">sitecore</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>Now we simply check if the field contains anything or if we are in page edit mode. All bases covered! Now when our field is empty, the Before, After and EnclosingTag contents are not rendered to the output, Keeping out razor script markup nice and clean and not leaving empty html tags in our site!</p>
<p>Happy Coding!</p>
<p>– Richard.</p>

      </div>
      <footer class="article-footer">
        <a data-url="http://www.sitecorenutsbolts.net/2015/10/26/Sitecore-Render-Field-Before-and-After-Values/" data-id="cka5tzga9005egsvr0agot9q4" class="article-share-link">Share</a>
        
          <a href="http://www.sitecorenutsbolts.net/2015/10/26/Sitecore-Render-Field-Before-and-After-Values/#comments" class="article-comment-link">Comments</a>
        
        
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Pipelines/">Pipelines</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Render-Field/">Render Field</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Sitecore/">Sitecore</a></li></ul>

      </footer>
    </div>
  </article>
  
    <section id="comments">
      <div id="disqus_thread">
        <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
      </div>
    </section>
  


<!-- Go to www.addthis.com/dashboard to customize your tools -->
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-55d6161f325b85fa" async="async"></script>
            </div>
          </section>
          <aside id="sidebar">
  <a class="sidebar-toggle" title="Expand Sidebar"><i class="toggle icon"></i></a>
  <div class="sidebar-top">
    <p>follow:</p>
    <ul class="social-links">
      
    </ul>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2015/11/03/Always-Include-Server-Url-without-a-HttpContext/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">newer</strong>
      <p class="article-nav-title">
        
          Always Include Server Url without a HttpContext
        
      </p>
      <i class="icon" id="icon-chevron-right"></i>
    </a>
  
  
    <a href="/2015/10/23/Rendering-Exception-Handling-The-Right-Way/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">older</strong>
      <p class="article-nav-title">Rendering Exception Handling - The Right Way</p>
      <i class="icon" id="icon-chevron-left"></i>
    </a>
  
</nav>

  
  <div class="widgets-container">
    
  </div>
</aside>
        </div>
      </div>
    </div>
    <footer id="footer">
  
  <div class="container">
    <div class="container-inner">
      <a id="back-to-top" href="javascript:;"><i class="icon" id="icon-angle-up"></i></a>
      <div class="credit">
        <h1 class="logo-wrap">
          <a href="/" class="logo"></a>
        </h1>
        <p>&copy; 2020 Richard Seal</p>
        <p>Powered by <a href="//hexo.io/" target="_blank">Hexo</a>.
      </p></div>
    </div>
  </div>
</footer>
    
<script>
  var disqus_shortname = 'sitecorenutsbolts';
  
  var disqus_url = 'http://www.sitecorenutsbolts.net/2015/10/26/Sitecore-Render-Field-Before-and-After-Values/';
  
  (function(){
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>



  <script src="http://code.jquery.com/jquery-2.1.3.min.js"></script>






<script src="/js/html-patch.js"></script>
<script src="/js/script.js"></script>
<script src="/js/readingTime.min.js"></script>

<script>
  $(function() {
    $('.article-entry').readingTime();
  });
</script>

  </div>
</body>
</html>
