<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="utf-8">
  
  <title>Watch your Guid format! | Sitecore Nuts &amp; Bolts</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="Maybe this should be in a “how to break Sitecore” section! Question: Which of these Guid formats is valid? 123456var ex1 = new Guid(&quot;00000000000000000000000000000000&quot;);var ex2 = new Guid(&quot;00000000-000">
<meta property="og:type" content="article">
<meta property="og:title" content="Watch your Guid format!">
<meta property="og:url" content="http://www.sitecorenutsbolts.net/2016/06/02/Watch-your-Guid-format/index.html">
<meta property="og:site_name" content="Sitecore Nuts &amp; Bolts">
<meta property="og:description" content="Maybe this should be in a “how to break Sitecore” section! Question: Which of these Guid formats is valid? 123456var ex1 = new Guid(&quot;00000000000000000000000000000000&quot;);var ex2 = new Guid(&quot;00000000-000">
<meta property="og:locale" content="en">
<meta property="og:updated_time" content="2020-05-12T14:52:21.860Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Watch your Guid format!">
<meta name="twitter:description" content="Maybe this should be in a “how to break Sitecore” section! Question: Which of these Guid formats is valid? 123456var ex1 = new Guid(&quot;00000000000000000000000000000000&quot;);var ex2 = new Guid(&quot;00000000-000">
  
  

  <link rel="stylesheet" href="/css/style.css">
  
  
  


  

<!--
  
    <link href='//fonts.useso.com/css?family=Titillium+Web:300,400,600' rel='stylesheet' type='text/css'>
    <link href="//fonts.useso.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
-->
</head>
</html>
<body>
  <div id="wrap">
    <header id="header">
  <div id="header-outer" class="outer">
    <div class="container">
      <div class="container-inner">
        <div id="header-title">
          <h1 class="logo-wrap">
            <a href="/" class="logo"></a>
          </h1>
          
            <h2 class="subtitle-wrap">
              <p class="subtitle">Design it, Code it, Build it. C# &amp; Sitecore!</p>
            </h2>
          
          
          <div class="mvp">
            <a href="http://www.sitecore.net/mvp" target="_blank">
              <img src="/about/index/MVP2016.jpg" alt="Sitecore MVP 2016-2020">
            </a>
            <a href="http://www.sitecore.net/mvp" target="_blank">
              <img src="/about/index/Technology2020.jpg" alt="Sitecore MVP 2016-2020">
            </a>
            <a href="http://www.sitecore.net/mvp" target="_blank">
              <img src="/about/index/Technology2019.jpg" alt="Sitecore MVP 2016-2020">
            </a>
            <a href="http://www.sitecore.net/mvp" target="_blank">
              <img src="/about/index/Technology2018.jpg" alt="Sitecore MVP 2016-2020">
            </a>
            <a href="http://www.sitecore.net/mvp" target="_blank">
                <img src="/about/index/Technology2017.jpg" alt="Sitecore MVP 2016-2020">
            </a>
            <a href="http://www.sitecore.net/mvp" target="_blank">
                <img src="/about/index/Technology2016.jpg" alt="Sitecore MVP 2016-2020">
            </a>
          </div>
          
        </div>
        <div id="header-inner" class="nav-container">
          <a id="main-nav-toggle" class="nav-icon"></a>
          <div class="nav-container-inner">
            <ul id="main-nav">
              
            </ul>
            <nav id="sub-nav">
              <div id="search-form-wrap">
                <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><input type="hidden" name="sitesearch" value="http://www.sitecorenutsbolts.net"></form>
              </div>
            </nav>
          </div>
        </div>
      </div>
    </div>
  </div>
</header>
    <div class="container">
      <div class="main-body container-inner">
        <div class="main-body-inner">
          <section id="main">
            <div class="main-body-header">

              <h1 class="header"><a class="page-title-link" href="/categories/Sitecore/">Sitecore</a></h1>
            </div>
            <div class="main-body-content">
              
  <article id="post-Watch-your-Guid-format" class="article article-single article-type-post" itemscope itemprop="blogPost">
    <div class="article-inner">
      <!--  -->
      
        <header class="article-header">
          
  
    <h1 class="article-title" itemprop="name">
      Watch your Guid format!
    </h1>
  

        </header>
      
      <p class="article-byline">
        <a href="/2016/06/02/Watch-your-Guid-format/" class="article-date">
  <time datetime="2016-06-02T18:22:48.000Z" itemprop="datePublished">2016-06-02</time>
</a>
      </p>
      <div class="article-entry" itemprop="articleBody">
        <code>Estimated reading time:<span class="eta"></span></code>
        <p>Maybe this should be in a “how to break Sitecore” section!</p>
<p><strong>Question:</strong> Which of these <code>Guid</code> formats is valid?</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> ex1 = <span class="keyword">new</span> Guid(<span class="string">"00000000000000000000000000000000"</span>);</span><br><span class="line"><span class="keyword">var</span> ex2 = <span class="keyword">new</span> Guid(<span class="string">"00000000-0000-0000-0000-000000000000"</span>);</span><br><span class="line"><span class="keyword">var</span> ex3 = <span class="keyword">new</span> Guid(<span class="string">"&#123;00000000-0000-0000-0000-000000000000&#125;"</span>);</span><br><span class="line"><span class="keyword">var</span> ex4 = <span class="keyword">new</span> Guid(<span class="string">"(00000000-0000-0000-0000-000000000000)"</span>);</span><br><span class="line"><span class="keyword">var</span> ex5 = <span class="keyword">new</span> Guid(<span class="string">"&#123;0x00000000,0x0000,0x0000,&#123;0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00&#125;&#125;"</span>);</span><br><span class="line"><span class="keyword">var</span> ex6 = <span class="keyword">new</span> Guid(<span class="string">"Why-Wont-You-Be-My-Friend?"</span>);</span><br></pre></td></tr></table></figure>
<p><strong>Answer:</strong> The first 5 are perfectly valid <code>Guid</code> formats, <em>unless</em> you need to index those values with Sitecore!</p>
<h4 id="ShortID-Encode-is-picky-about-formats"><a href="#ShortID-Encode-is-picky-about-formats" class="headerlink" title="ShortID.Encode is picky about formats!"></a>ShortID.Encode is picky about formats!</h4><p>When adding a <code>Guid</code> to an index Sitecore uses the <code>ShortID</code> data type instead of the full Guid, this <code>ShortID</code> formats the <code>Guid</code> without hyphens or braces. This is great for indexes, it makes the value easily searchable by both Lucene and SOLR. Its also pretty useful in other area’s. You might use it to add your Item ID to a query string or link so that you don’t have to Url encode the values etc…</p>
<p>So pretty useful!</p>
<p>BUT, the method to encode a <code>Guid</code> to a <code>ShortID</code> is not very forgiving. Here it is:  </p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span>Converts a string to a ShortID.<span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name="guid"&gt;</span>The GUID.<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>The encode.<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">string</span> <span class="title">Encode</span>(<span class="params"><span class="keyword">string</span> guid</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Assert.ArgumentNotNull((<span class="keyword">object</span>) guid, <span class="string">"guid"</span>);</span><br><span class="line">    <span class="keyword">return</span> guid.Substring(<span class="number">1</span>, <span class="number">8</span>) + guid.Substring(<span class="number">10</span>, <span class="number">4</span>) + guid.Substring(<span class="number">15</span>, <span class="number">4</span>) + guid.Substring(<span class="number">20</span>, <span class="number">4</span>) + guid.Substring(<span class="number">25</span>, <span class="number">12</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>So you can see the problem!</p>
<ul>
<li>First it takes a string, not a Guid object. Yes there is an overload that takes a Guid and formats it as a string, but you are not forced to use that.</li>
<li>Second, apart from checking if the value is null, no other validation is done. This code would pass all validation:<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> myShortId = ShortID.Encode(<span class="string">"Will you be my friend?"</span>);</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>Right away, the code assumes that the string is the correct length and that all the parts of the <code>Guid</code> are in the correct place. <em>Any</em> deviation to that results in an untrapped exception. This means that in the above list, examples 1, 2 and 5 would all cause an exception in your code.</p>
<p>The big problem here is that if you programatically edit a link or list field, you <strong>must</strong> make sure that you format the <code>Guid</code> correctly, otherwise you will end up with some nasty errors in the crawling log file. Fortunately there is a helper method for this:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">// Sitecore utility method</span><br><span class="line">var guidString = MainUtil.GuidToString(myGuid);</span><br><span class="line"></span><br><span class="line">// Or just to string it</span><br><span class="line">var guidString2 = myGuid.ToString(&quot;B&quot;);</span><br></pre></td></tr></table></figure>
<h3 id="TL-DR"><a href="#TL-DR" class="headerlink" title="TL/DR;"></a>TL/DR;</h3><p>So if you are going to use <code>ShortID.Encode</code> - make sure you pass in the right format or you are going to get some unexpected results!</p>

      </div>
      <footer class="article-footer">
        <a data-url="http://www.sitecorenutsbolts.net/2016/06/02/Watch-your-Guid-format/" data-id="cka5tzgas006tgsvr0rcqsgtl" class="article-share-link">Share</a>
        
          <a href="http://www.sitecorenutsbolts.net/2016/06/02/Watch-your-Guid-format/#comments" class="article-comment-link">Comments</a>
        
        
      </footer>
    </div>
  </article>
  
    <section id="comments">
      <div id="disqus_thread">
        <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
      </div>
    </section>
  


<!-- Go to www.addthis.com/dashboard to customize your tools -->
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-55d6161f325b85fa" async="async"></script>
            </div>
          </section>
          <aside id="sidebar">
  <a class="sidebar-toggle" title="Expand Sidebar"><i class="toggle icon"></i></a>
  <div class="sidebar-top">
    <p>follow:</p>
    <ul class="social-links">
      
    </ul>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2016/06/28/Setting-up-Solr-on-Habitat/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">newer</strong>
      <p class="article-nav-title">
        
          Setting up Solr on Habitat
        
      </p>
      <i class="icon" id="icon-chevron-right"></i>
    </a>
  
  
    <a href="/2016/05/27/Watchout-You-are-in-the-web-db/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">older</strong>
      <p class="article-nav-title">Watchout! You are in the web db!</p>
      <i class="icon" id="icon-chevron-left"></i>
    </a>
  
</nav>

  
  <div class="widgets-container">
    
  </div>
</aside>
        </div>
      </div>
    </div>
    <footer id="footer">
  
  <div class="container">
    <div class="container-inner">
      <a id="back-to-top" href="javascript:;"><i class="icon" id="icon-angle-up"></i></a>
      <div class="credit">
        <h1 class="logo-wrap">
          <a href="/" class="logo"></a>
        </h1>
        <p>&copy; 2020 Richard Seal</p>
        <p>Powered by <a href="//hexo.io/" target="_blank">Hexo</a>.
      </p></div>
    </div>
  </div>
</footer>
    
<script>
  var disqus_shortname = 'sitecorenutsbolts';
  
  var disqus_url = 'http://www.sitecorenutsbolts.net/2016/06/02/Watch-your-Guid-format/';
  
  (function(){
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>



  <script src="http://code.jquery.com/jquery-2.1.3.min.js"></script>






<script src="/js/html-patch.js"></script>
<script src="/js/script.js"></script>
<script src="/js/readingTime.min.js"></script>

<script>
  $(function() {
    $('.article-entry').readingTime();
  });
</script>

  </div>
</body>
</html>
